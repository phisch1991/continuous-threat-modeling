# Continuous Threat Modeling

## Einleitung

Bedrohungsanalysen (oder englisch: Threat Modeling) sind ein probates Mittel, IT-Infrastrukturen und Anwendungen gegen Bedrohungen zu schützen, indem diese systematisch identifiziert und daraus resultierende Risiken mitigiert werden. Typischerweise finden Bedrohungsanalysen im professionellen Umfeld in einem festgelegten Turnus oder zu bestimmten Events statt, beispielsweise bei umfangreichen Änderungen der System-Architektur. Durchgeführt werden diese durch eine enge Zusammenarbeit zwischen IT-Sicherheitsspezialisten und dem jeweils zuständigen technischen Architekten.

Die bisherige Vorgehensweise lässt Bedrohungsanalysen als ein besonderes Ereignis erscheinen, das von ausgewählten Personen begleitet wird und zusätzlichen Aufwand abseits des Tagesgeschäfts mit sich bringt. Aber wie lässt sich dies mit Entwicklungsteams vereinen, die in den letzten Jahren durch die Implementierung agiler Arbeitsmethoden festgelegte Rollen zugunsten einer Team-Verantwortung abgelegt haben und durch die kontinuierliche Automatisierung Änderungen in einer hohen Frequenz bis in die Produktionsumgebung liefern?

Andere Bereiche der Entwicklung sind bereits im agilen Alltag angekommen und werden bestens durch neue Vorgehensweisen und Werkzeuge unterstützt. Dokumentation beispielsweise wird nicht mehr mit separaten Textverarbeitungsprogrammen verwaltet, sondern direkt in der Versionsverwaltung, oft sogar in maschinenlesbarer Form. Auch Tests sind schon lange nicht mehr der separaten Testabteilung vorbehalten, in der Test-Design, -Durchführung und -Auswertung getrennt von der Entwicklung erfolgen. Durch die hohe Änderungsfrequenz sind Tests auf allen Ebenen in automatisierter Form unerlässlich. Und auch Sicherheitstests wie Vulnerability & Compliance Scanner sind bereits in den Build- und Deployment-Pipelines der DevOps Teams angekommen.

## Zukunft von Bedrohungsanalysen

Warum Bedrohungsanalysen erst langsam diesem Trend folgen, hat verschiedene Gründe. Zum einen haben Bedrohungsanalysen oft außerhalb der Blickweite des Teams stattgefunden, nämlich zwischen IT-Sicherheitsspezialisten und einem ausgewählten Team-Mitglied, in den meisten Fällen dem Architekten. Lediglich die Umsetzung der Maßnahmen lag in der Hand des Teams. Dies hat zur Folge, dass der Kontext, aus dem diese Maßnahmen abgeleitet wurden, verloren geht und das Team letztlich Dinge umsetzt, ohne ein Verständnis für das Problem zu erhalten. Außerdem wird oft vermutet, dass für die Analysen spezielles, Experten vorbehaltenes Wissen notwendig ist. Zuletzt sorgen Prozessabläufe für eine nicht hilfreiche Wahrnehmung: Bedrohungsanalysen werden als eine Tätigkeit angesehen, die das Unternehmen vom Team fordert. Dabei sollte es genau umgekehrt sein: Das Team sollte aus eigenem Interesse Bedrohungsanalysen durchführen, gerne unterstützt durch Angebote des Unternehmens.

Doch wie kann die Zukunft von Bedrohungsanalysen aussehen? Zunächst einmal ist es wichtig, alle an der Entwicklung beteiligten Personen in den Prozess zu integrieren. Dies sorgt erstens für ein höheres Verantwortungsgefühl des Gesamtteams für die Sicherheit des Systems, zweitens aber auch für stärkere Wissensverteilung im Team, was die Ergebnisse der Analyse sowie geeignete Gegenmaßnahmen betrifft. Außerdem kennt kaum jemand das System - und damit auch seine Schwachstellen - besser als der/die Entwickler:in selbst. 

Ein weiterer Erfolgsfaktor ist die starke Integration der Bedrohungsanalyse in die Team-Prozesse. Verfolgt das Team beispielsweise eine konsequente Everything-as-Code-Strategie, sollten auch die unterstützenden Tools diesem Credo folgen. Dies sorgt vorallem dafür, dass das Team mit Tools arbeiten kann, mit denen es sowieso tagtäglich arbeitet (in diesem Beispiel mit der IDE).

## Ansätze für Bedrohungsanalysen

Für Bedrohungsanalysen in DevOps Teams gibt es mehrere Ansätze. Es bietet sich an, diese in Workshops zu kombinieren, um einerseits systematische und verlässliche Ergebnisse zu erhalten, andererseits auch das breite Wissen des Teams zu nutzen und insbesondere realistische Szenarien in den Vordergrund zu rücken. 

_Kreativer Ansatz:_ Eine exemplarische Frage für diesen Ansatz lautet "Stell dir vor, dass eine der größten Tageszeitungen über einen Einbruch in unser IT-System berichtet. Was könnte passiert sein?". Der Ansatz eignet sich besonders für den Einstieg ins Thema sowie als Warm-Up für Workshops, da keine falschen Antworten möglich sind und die Kreativität angeregt wird. Dies führt dazu, dass out-of-the-box gedacht wird. Der Erfolg ist abhängig von der individuellen Beteiligung der Teilnehmer.

_Szenario-basierter Ansatz:_ Bei diesem Ansatz stehen konkrete Szenarien im Vordergrund: "Stell dir vor, ein Angreifer hat Shell-Zugriff im Docker-Container unserer Web-Anwendung erhalten. Was könnte als nächstes passieren? Wie könnten wir ihn stoppen?" Da hier echte Schadensszenarien besprochen werden, wird nicht nur eine theoretische Diskussion angeregt, sondern auch direkt nach praktischen Auswirkungen geschaut. Besonders bei Defense-in-Depth Überlegungen ist dieser Ansatz erfolgsversprechend.

_Systematischer Ansatz:_ Systematische Ansätze wie STRIDE dürfen natürlich nicht fehlen. Diese stellen sicher, dass Bedrohungen aus allen üblichen Kategorien betrachtet werden und kein blinder Fleck entsteht. Gerade für Teams, die sich anfänglich mit Bedrohungsanalysen beschäftigen, bietet dieser Ansatz aus zweierlei Sicht eine Hilfestellung: Er vermittelt einen Eindruck über die Bandbreite der möglichen Bedrohungen und führt das Team gleichzeitig Schritt für Schritt durch die verschiedenen Kategorien.

_Automatischer/Regelbasierter Ansatz:_ Als Ergänzung zu den oben genannten Ansätzen können Bedrohungen zudem durch Automatismen und Regeln erkannt werden. Beispielsweise kann ein solches System das Team darauf hinweisen, dass eine im Internet exponierte Web Applikation mit einer Datenbank-Kommunikation grundsätzlich einer SQL-Injection ausgesetzt sein kann und es geeigneter Gegenmaßnahmen bedarf. Dieser Ansatz sollte toolunterstützt sein und bedarf einer maschinenlesbaren Form des System-Models sowie eines geeigneten Regelsets. Realisierbar ist das beispielsweise mit Tools wie Threagile. Die Aufgabe des Teams ist hierbei neben der Integration eines solchen Tools die Bewertung der Hinweise, die das Tool gibt. Ein Vorteil liegt darin, dass aktiv auf übliche Risiken hingewiesen wird (z.B. OWAS Top Ten) und somit Compliance und Markt-Standards unterstützt werden können (z. B. CIS Benchmarks).

## Umsetzung

Wie nun diese Strategie in der unternehmerischen Praxis umgesetzt werden kann, zeigen die folgenden fünf Schritte: Der Security Scout, die Vorbereitung, die Regelmäßigkeit, die Normalität und letztlich die vollständige Integration.

_Security Scout:_ Um das Team auf die kommenden Aufgaben vorzubereiten, ist es sinnvoll, eine Rolle einzuführen, die sich besonders um das Thema IT-Sicherheit im Team kümmert. Anders als bisherige exklusive Rollen ist damit aber nicht gemeint, dass sich nur diese Person um die Sicherheit des Systems kümmert und verantwortlich fühlt - die Verantwortung für die Sicherheit liegt im Gesamtteam. Vielmehr ist es eine Art Scout, der das Team unterstützt, die neuen Aufgaben wahrzunehmen, indem er/sie den Freiraum hat, sich mit Neuigkeiten im Bereich IT-Sicherheit auseinanderzusetzen, das Team organisatorisch beispielsweise im Rahmen von Workshops anzuleiten und auch kritische Fragen zu stellen. Dabei ist darauf zu achten, dass es sich nicht um eine Vollzeit-Aufgabe handelt, da ansonsten das Risiko einer Separierung besteht. Die Rolle sollte weiterhin von jemandem wahrgenommen werden, der/die den Rückhalt des Teams hat. Eine externe Nominierung dieser Person sollte vermieden werden.

_Vorbereitung:_ Um einen Einstieg in das Thema Bedrohungsanalysen zu schaffen, bietet es sich an, einen initialen Workshop durchzuführen. Maßgebliches Ziel sollte sein, dass die Bedrohungsanalyse nicht mehr als eine exklusive, außerhalb des Teams stattfindende und langweilige Tätigkeit betrachtet wird. Dafür sollten die möglichen Ansätze und Methoden erklärt und ein Tool ausgewählt werden - dies kann zu Beginn auch ein Whiteboard sein. Optimalerweise wird bereits jetzt eine erste Threat Modeling Iteration durchgeführt, da dadurch von der Metaebene auf die tatsächliche Anwendung gewechselt und erste Berührungsängste beseitigt werden.

_Regelmäßigkeit:_ Nachdem das Team auf die bevorstehenden Aufgaben vorbereitet wurde, ist es wichtig, die Bedrohungsanalyse zu einer regelmäßigen Tätigkeit zu machen, beispielsweise im Rahmen eines monatlich stattfindenden, 2-stündigen Regeltermins. Ziel jedes Meetings ist es, zu prüfen, ob das Bedrohungsmodell vollständig und noch aktuell ist und welche Dinge sich seit der letzten Iteration geändert haben (neue Systeme, entfernte Komponenten, veränderte Kommunikationsbeziehungen, usw.). Um das Meeting attraktiv zu gestalten, bieten sich insbesondere kreative oder szenario-basierte Ansätze an. 

_Normalität:_ Obwohl nun die Bedrohungsanalyse bereits wesentlich regelmäßiger durchgeführt wird und die Aktualität sowie das Wissen im Team gesteigert wurde, sollte darauf hingearbeitet werden, die Analyse nicht mehr als explizite Veranstaltung zu sehen, sondern als Aufgabe im Rahmen der normalen Meetings (im Falle von Scrum beispielsweise im Sprint Refinement Prozess sowie im Sprint Planning Meeting oder auch im Review). Optimalerweise werden die Diskussionen Schritt für Schritt dorthin verlagert und das regelmäßige Bedrohungsanalyse-Meeting immer weiter reduziert. Es ist wichtig, dass das Team motiviert wird, Sicherheitsaspekte sofort zu diskutieren, wenn sie - beispielsweise im regulären Planungsprozess - auftreten, um zu vermeiden, dass diese zum nächsten regelmäßigen Bedrohungsanalyse-Meeting aufgeschoben werden. Dies fördert im Team das Verständnis dafür, dass die Planung der technischen Umsetzung unabdingbar mit Sicherheitsüberlegungen einhergehen.

_Vollständig integriert:_ Der komplette Bedrohungsanalyse-Prozess ist nun stark in die alltägliche Arbeitsweise des Teams integriert, findet regelmäßig statt, ohne dass es ein separates Meeting benötigt und wurde vom Team verstanden.

## Fazit

Um Bedrohungsanalysen im DevOps Umfeld an die gesteigerte Entwicklungs- und Deployment-Frequenz anzupassen und die Kenntnisse und Fähigkeiten auch im Team zu verankern, sind verschiedene Aspekte notwendig: Verschiedenartige Ansätze können einerseits helfen, Bedrohungsanalysen abwechslungsreich und selbsterklärend für das Team zu gestalten, andererseits die gesamte Bandbreite abdecken, von automatisierter Identifizierung von Bedrohungen bis hin zu sehr team- und systemindividuellen Punkten. Die kontinuierliche Implementierung durch die Förderung des Sicherheitsdenkens im Team über die regelmäßige Durchführung von Analysen bis hin zur vollständigen Integration in den Entwicklungsprozess stellt sicher, dass das Team Schritt für Schritt das notwendige Wissen wie auch das Verständnis für Sicherheitsaspekte aufbaut. Ziel ist es, ein autarkes Team zu formen, das sich abseits der Checkbox-Compliance selbst für die Sicherheit der entwickelten und betriebenen Komponenten in der Verantwortung sieht und auf Sicherheit spezialisierte Einheiten des Unternehmens als Beratungsangebot und nicht als Last oder Exekutive betrachtet.